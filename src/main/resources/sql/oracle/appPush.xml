<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="eorder.appPush">
	<insert id="in" parameterType="hashmap">
		INSERT INTO APPPUSH (
			AP_SEQ,
			AP_USERID,
			AP_APPPUSHKEY,
			AP_TITLE,
			AP_CONTENT,
			<if test='m_apsendyn != null and "Y".equals(m_apsendyn)'>AP_SENDDATE,</if>
			AP_SENDYN,
			AP_SENDTYPE,
			AP_MOVEURL,
			AP_TYPE,
			AP_INDATE
		) 
		VALUES (
			USQ_APPPUSH.NEXTVAL,
			#{m_apuserid, jdbcType=VARCHAR},
			#{m_apapppushkey, jdbcType=VARCHAR},
			#{m_aptitle, jdbcType=VARCHAR},
			#{m_apcontent, jdbcType=VARCHAR},
			<if test='m_apsendyn != null and "Y".equals(m_apsendyn)'>SYSDATE,</if>
			#{m_apsendyn, jdbcType=VARCHAR},
			#{m_apsendtype, jdbcType=VARCHAR},
			#{m_apmoveurl, jdbcType=VARCHAR},
			#{m_aptype, jdbcType=VARCHAR},
			SYSDATE
		)
		<selectKey resultType="long" keyProperty="nowSeq" order="AFTER">
			SELECT USQ_APPPUSH.CURRVAL FROM DUAL
		</selectKey>
	</insert>
	
	<insert id="inByUser" parameterType="hashmap">
		INSERT INTO APPPUSH (
			AP_SEQ,
			AP_USERID,
			AP_APPPUSHKEY,
			AP_TITLE,
			AP_CONTENT,
			<if test='m_apsendyn != null and "Y".equals(m_apsendyn)'>AP_SENDDATE,</if>
			AP_SENDYN,
			AP_SENDTYPE,
			AP_MOVEURL,
			AP_TYPE,
			AP_INDATE
		) 
		SELECT 
			USQ_APPPUSH.NEXTVAL,
			USERID, 
			USER_APPPUSHKEY,
			#{m_aptitle, jdbcType=VARCHAR},
			#{m_apcontent, jdbcType=VARCHAR},
			<if test='m_apsendyn != null and "Y".equals(m_apsendyn)'>SYSDATE,</if>
			#{m_apsendyn, jdbcType=VARCHAR},
			#{m_apsendtype, jdbcType=VARCHAR},
			#{m_apmoveurl, jdbcType=VARCHAR},
			#{m_aptype, jdbcType=VARCHAR},
			SYSDATE
		FROM O_USER
		<where>
			<if test="ri_userid != null and ri_userid != ''">AND USERID IN <foreach collection="ri_userid" item="userid" separator="," open="(" close=")">#{userid}</foreach></if>
		</where>
	</insert>
</mapper>